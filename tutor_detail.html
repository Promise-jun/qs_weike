<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>情说微课-音频专栏</title>
	<meta name = "viewport" content = "width = device-width, initial-scale = 1.0, maximum-scale = 1.0, user-scalable = 0" />
	<!-- head 中 -->
	<link rel="stylesheet" type="text/css" href="./css/weui.min.css">
	<link rel="stylesheet" type="text/css" href="./css/jquery-weui.min.css">
	<link rel="stylesheet" type="text/css" href="./css/qs_weike.css">
	<link rel="stylesheet" type="text/css" href="./css/swiper.min.css">
	<script type="text/javascript">
	    (function (doc, win) {
	      	var docEl = doc.documentElement,
	     	resizeEvt = 'orientationchange' in window
	        	? 'orientationchange'
	        	: 'resize',
	      	recalc = function () {
	        	var clientWidth = docEl.clientWidth
	        	if (!clientWidth) return
	       		docEl.style.fontSize = clientWidth / 18.75 + 'px'
	      	}
      		if (!doc.addEventListener) return
      		win.addEventListener(resizeEvt, recalc, false)
      		doc.addEventListener('DOMContentLoaded', recalc, false)
	    })(document, window)
	 </script>
</head>
<body>
	<div class="top_fixed">
		<div class="weui-flex top_box">
		  	<div class="weui-flex__item">
		  		<a href="javascript:;" class="back"></a>
		  		<a href="javascript:;" class="share"></a>
		  	</div>
		</div>
	</div>
	<div class="container tutor_detail">
		<div class="binner"><img src="images/icon_background.png"></div>
		<div class="tutor_info">
			<div class="tutor_head">
				<img src="images/timg-head.jpg" alt="">
				<a href="javascript:;" class="tutor_audio"></a>
			</div>
			<div class="tutor_data">
				<p>
					<span class="name">杨蕾</span>
					<!-- 女：sex_woman   男：sex_man -->
					<span class="sex_woman"></span>
					<!-- 在线：on_line  离线：off_line -->
					<span class="on_line"></span>
				</p>
				<p>
					<span class="location">浙江 杭州</span>
					<span class="grade">评分 5.0 </span>
				</p>
			</div>
		</div>
		<div class="weui-flex tutor_num">
		  	<div class="weui-flex__item">
		  		<p class="num">256</p>
		  		<p class="tool">已咨询人数</p>
		  	</div>
		  	<div class="weui-flex__item">
		  		<p class="num">2478</p>
		  		<p class="tool">粉丝</p>
		  	</div>
		  	<div class="weui-flex__item">
		  		<p class="num">129</p>
		  		<p class="tool">收到感谢</p>
		  	</div>
		</div>

		<div class="margin_num"></div>

		<!-- 相册 -->
		<div class="tutor_pic">
			<p class="title">相册</p>
			<div class="swiper-container pic_swiper">
				 <div class="swiper-wrapper">
		            <div class="swiper-slide">
		            	<img src="images/timg-head.jpg">
		            </div>
		            <div class="swiper-slide">
		            	<img src="images/bg.jpg">
		            </div>
		            <div class="swiper-slide">
		            	<img src="images/timg2.jpg">
		            </div>
		             <div class="swiper-slide">
		            	<img src="images/rule_case2.png">
		            </div>
		        </div>
			</div>
		</div>

		<div class="margin_num"></div>

		<div class="weui-flex top_tab">
		  	<div class="weui-flex__item active_tab">详情</div>
		  	<div class="weui-flex__item">课程</div>
		  	<div class="line_box">
		  		<div class="line"></div>
		  	</div>
		</div>
		<div class="audio_box">
			
		</div>

		<div class="margin_num" style="height: 59px;"></div>
	</div>
	<div class="foot_fixed">
		<!--  未购买 -->
		<div>
			<a href="javascript:functionList.footBtnFn();">¥89.9订阅</a>
		</div>
		<div class="audio_list_btns" style="display: none;">
			<a href="javascript:;">试听</a>
			<a href="javascript:functionList.footBtnFn();">¥89.9购买</a>
		</div>
		<!-- 购买了 -->
		<!-- <a href="javascript:;" class="download"><span>批量下载</span></a> -->
	</div>

	<!-- body 最后 -->
	<script type="text/javascript" src="./js/jquery-2.1.4.js"></script>
	<script type="text/javascript" src="./js/jquery-weui.min.js"></script>
	<script type="text/javascript" src="./js/swiper_weui.min.js"></script>
	<script type="text/javascript">
		$(function() {
			var tabTop = $('.top_tab').offset().top,
				topBoxH = $('.top_box').innerHeight(),
				isBack = $('.top_box').find('a').hasClass('back'),
				isShare = $('.top_box').find('a').hasClass('share');
			$(window).scroll(function() {
				functionList.scroll_opacity($(this).scrollTop(), $('.top_box'), isBack, isShare);
				if ($(this).scrollTop() >= (tabTop - topBoxH)) {
					$('.top_tab').css({
						position: 'fixed',
						top: topBoxH
					})
					$('.audio_box').css({
						marginTop: 44 + 'px'
					})
				} else {
					$('.top_tab').css({
						position: 'relative',
						top: 0
					})
					$('.audio_box').css({
						marginTop: 0 + 'px'
					})
				}
			})


			// tab切换
			var len = $('.top_tab .weui-flex__item').length,
				leftNum = 21; //初始距离左边的百分比
				$lineObj = $('.line_box .line');
			$('.top_tab .weui-flex__item').on('click', function() {
				var index = $(this).index();
				functionList.changeLine(index, len, leftNum, $lineObj);
				$(this).addClass('active_tab').siblings().removeClass('active_tab');
				$('.audio_box>div').hide();
				$('.audio_box>div').eq(index).fadeIn(200);
				$('.foot_fixed>div').eq(index).show().siblings('div').hide();
			})


			// swiper
			var picItems = [
				"images/timg-head.jpg",
			    "images/bg.jpg",
			    "images/timg2.jpg",
			    "images/rule_case2.png"
		    ]
			var picSwiper = new Swiper('.pic_swiper', {
		        slidesPerView: 3.2,
		        breakpoints: { 
				    //当宽度小于等于480
				    480: {
				      spaceBetween: 10
				    },
				   //当宽度小于等于750
				    750: { 
				      spaceBetween: 20
				    },
				    //当宽度小于等于1242
				    1242: {
				      spaceBetween: 30
				    }
				},
				onTap: function(swiper){
					var pic = $.photoBrowser({
						items: picItems,
						initIndex: swiper.clickedIndex
					});
					pic.open()
			    }
		    });
		})

		var functionList = {
			// 点击底部按钮
			footBtnFn: function() {
				alert(1)
			},
			// tab切换改变line位置
			changeLine: function(index, len, leftNum, $lineObj) {
				$lineObj.animate({
					left: ((100 / len) * index + leftNum).toFixed(2) + '%'
				}, 200);
			},
			// 滚动改变透明度
			scroll_opacity: function(scrollNum, $obj, isBack, isShare) {
				if (scrollNum >= 150) {
					$obj.addClass('opacity_active');
					if (isBack) {
						$obj.find('.back').css({
							background: 'url("../images/icon_top_back@2x.png") no-repeat center',
							backgroundSize: 'contain'
						})
					}
					if (isShare) {
						$obj.find('.share').css({
							background: 'url("../images/icon_top_share@2x.png") no-repeat center',
							backgroundSize: 'contain'
						})
					}
				} else {
					$obj.removeClass('opacity_active');
					if (isBack) {
						$obj.find('.back').css({
							background: 'url("../images/back.png") no-repeat center',
							backgroundSize: 'contain'
						})
					}
					if (isShare) {
						$obj.find('.share').css({
							background: 'url("../images/icon_frequency_share@2x.png") no-repeat center',
							backgroundSize: 'contain'
						})
					}
				}
			}
		}
	</script>
</body>
</html>